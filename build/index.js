"use strict";var Forecast=function(){var t=6e5,e=null,o=[],n=null,r=null,a=null,i=null,s=null;return{getIsUS:function(){return n},setIsUS:function(t){n=t},refreshTimer:function(o){e-=1e3,e<0&&(this.updateWeather(),e=t),this.setTimer()},setTimer:function(){var t="",o="",n=Math.floor(e/1e3),r=Math.floor(n/60);n%=60,n<10&&(t="0"),r<10&&(o="0"),$("#timer").text("Next Update: "+o+r+":"+t+n)},updateLastUpdateTime:function(){var t=new Date,e=null;return e=t.getTime().toString(),this.getPrettyTime(t)},getPrettyTime:function(t){var e=t.getHours(),o=t.getMinutes(),n=e>=12?"pm":"am";return e%=12,e=0==e?12:e,o=o<10?"0"+o:o,e+":"+o+" "+n},fToC:function(t){return Math.round((t-32)*(5/9))},mToK:function(t){return Math.round(1.609344*t)},getIconText:function(t){return null==t||void 0==t?"Weather Description Unavailable":(t=t.replace(/-/g," "),t=t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1)}),t.replace(/\s(Day|Night)/,""))},setIconCSS:function(t){var e=["clear-day","clear-night","rain","snow","sleet","wind","fog","cloudy","partly-cloudy-day","partly-cloudy-night","hail","thunderstorm","tornado"];e.indexOf(t)==-1?"cloudy":t;$("#w-icon").attr("src","images/icons/"+t+".png"),$("#w-icon").attr("alt",t+" icon")},updateWeather:function(){var t=this;$("#location-time").text("Local Weather as of "+this.updateLastUpdateTime()),$.ajax({dataType:"jsonp",url:"https://api.forecast.io/forecast/e9097c35ea613c2b9cecdbe75e35d04c/"+o[0]+","+o[1],success:function(e){$("#w-description").text(t.getIconText(e.currently.icon)),t.setIconCSS(e.currently.icon),r=e.currently.temperature,a=t.fToC(r);var o=n?Math.round(r):Math.round(a);$("#w-temperature").text(o),$("#w-precipitation").text(Math.round(100*e.currently.precipProbability)),$("#w-humidity").text(Math.round(100*e.currently.humidity)),i=e.currently.windSpeed,s=t.mToK(i);var c=n?Math.round(i):Math.round(s);$("#w-windspeed").text(c),$(".weather-box").fadeIn(),$("#timer-container").fadeIn()},error:function(t){console.log("forecast.io request error: "+t)}})},geo_success:function(n){var r=this;$("#location").html("Loading Local Weather...</br></br>&nbsp;");var a=new google.maps.Geocoder,i=new google.maps.LatLng(n.coords.latitude,n.coords.longitude);o=[n.coords.latitude,n.coords.longitude],a.geocode({latLng:i},function(o,n){if(n==google.maps.GeocoderStatus.OK){var a=new Date,i=a.getTime().toString();o[1]?$("#location-address").text(o[1].formatted_address):$("#location-address").text("No-Named Mystery Location"),e=t,r.setTimer();setInterval(function(){r.refreshTimer(i)},1e3);r.updateWeather()}else $("#location").text("Google Maps error. Status: "+n)})},geo_error:function(){$("#location").text("Unable to find current location.")},setTempButtons:function(t,e){t===!1?($("#w-temperature-units").text("C"),$("#w-wind-units").text(" kph"),$("#temp-c-button").css({"background-color":"#666","box-shadow":"inset 0 0 5px 2px #222"}),$("#temp-f-button").css({"background-color":"#333","box-shadow":"none"}),e===!0&&(n=!1,localStorage.setItem("isUS","false"),$("#w-temperature").text(Math.round(a)),$("#w-windspeed").text(Math.round(s)))):(n=!0,localStorage.setItem("isUS","true"),$("#w-temperature").text(Math.round(r)),$("#w-windspeed").text(Math.round(i)),$("#w-temperature-units").text("F"),$("#w-wind-units").text(" mph"),$("#temp-f-button").css({"background-color":"#666","box-shadow":"inset 0 0 5px 2px #222"}),$("#temp-c-button").css({"background-color":"#333","box-shadow":"none"}))}}};$(document).ready(function(){var t=new Forecast;t.setIsUS($.parseJSON(localStorage.getItem("isUS"))),null==t.getIsUS()&&(t.setIsUS(!0),localStorage.setItem("isUS","true")),t.getIsUS()===!1&&t.setTempButtons(!1,!1),navigator.geolocation?navigator.geolocation.getCurrentPosition(t.geo_success.bind(t),t.geo_error,{timeout:3e4}):t.geo_error(),$("#temp-f-button").on("click",function(e){e.preventDefault(),t.getIsUS()===!1&&t.setTempButtons(!0,!0)}),$("#temp-c-button").on("click",function(e){e.preventDefault(),t.getIsUS()===!0&&t.setTempButtons(!1,!0)})});