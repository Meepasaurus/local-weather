"use strict";function refreshTimer(t,e){timeToRefresh-=1e3,timeToRefresh<0&&(updateWeather(),timeToRefresh=e),setTimer()}function setTimer(){var t="",e="",o=Math.floor(timeToRefresh/1e3),r=Math.floor(o/60);o%=60,o<10&&(t="0"),r<10&&(e="0"),$("#timer").text("Next Update: "+e+r+":"+t+o)}function updateLastUpdateTime(){var t=new Date,e=null;return e=t.getTime().toString(),getPrettyTime(t)}function getPrettyTime(t){var e=t.getHours(),o=t.getMinutes(),r=e>=12?"pm":"am";return e%=12,e=0==e?12:e,o=o<10?"0"+o:o,e+":"+o+" "+r}function getIconText(t){return null==t||void 0==t?"Weather Description Unavailable":(t=t.replace(/-/g," "),t=t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1)}),t.replace(/\s(Day|Night)/,""))}function setIconCSS(t){var e=["clear-day","clear-night","rain","snow","sleet","wind","fog","cloudy","partly-cloudy-day","partly-cloudy-night","hail","thunderstorm","tornado"];e.indexOf(t)==-1?"cloudy":t;$("#w-icon").attr("src","https://github.com/Meepasaurus/fcc-images/blob/master/local-weather/icons/"+t+".png?raw=true"),$("#w-icon").attr("alt",t+" icon")}function fToC(t){return Math.round((t-32)*(5/9))}function mToK(t){return Math.round(1.609344*t)}function updateWeather(){$("#location-time").text("Local Weather as of "+updateLastUpdateTime()),$.ajax({dataType:"jsonp",url:"https://api.forecast.io/forecast/e9097c35ea613c2b9cecdbe75e35d04c/"+currentLatLng[0]+","+currentLatLng[1],success:function(t){$("#w-description").text(getIconText(t.currently.icon)),setIconCSS(t.currently.icon),tempF=t.currently.temperature,tempC=fToC(tempF);var e=isUS?Math.round(tempF):Math.round(tempC);$("#w-temperature").text(e),$("#w-precipitation").text(Math.round(100*t.currently.precipProbability)),$("#w-humidity").text(Math.round(100*t.currently.humidity)),windM=t.currently.windSpeed,windK=mToK(windM);var o=isUS?Math.round(windM):Math.round(windK);$("#w-windspeed").text(o),$(".weather-box").fadeIn(),$("#timer-container").fadeIn()},error:function(t){console.log("forecast.io request error: "+t)}})}function geo_success(t){$("#location").html("Loading Local Weather...</br></br>&nbsp;");var e=new google.maps.Geocoder,o=new google.maps.LatLng(t.coords.latitude,t.coords.longitude);currentLatLng=[t.coords.latitude,t.coords.longitude],e.geocode({latLng:o},function(t,e){if(e==google.maps.GeocoderStatus.OK){var o=new Date,r=null,r=o.getTime().toString();t[1]?$("#location-address").text(t[1].formatted_address):$("#location-address").text("No-Named Mystery Location"),timeToRefresh=refreshTime,setTimer();setInterval(function(){refreshTimer(r,refreshTime)},1e3);updateWeather()}else $("#location").text("Google Maps error. Status: "+e)})}function geo_error(){$("#location").text("Unable to find current location.")}function setTempButtons(t,e){t===!1?($("#w-temperature-units").text("C"),$("#w-wind-units").text(" kph"),$("#temp-c-button").css({"background-color":"#666","box-shadow":"inset 0 0 5px 2px #222"}),$("#temp-f-button").css({"background-color":"#333","box-shadow":"none"}),e===!0&&(isUS=!1,localStorage.setItem("isUS","false"),$("#w-temperature").text(Math.round(tempC)),$("#w-windspeed").text(Math.round(windK)))):(isUS=!0,localStorage.setItem("isUS","true"),$("#w-temperature").text(Math.round(tempF)),$("#w-windspeed").text(Math.round(windM)),$("#w-temperature-units").text("F"),$("#w-wind-units").text(" mph"),$("#temp-f-button").css({"background-color":"#666","box-shadow":"inset 0 0 5px 2px #222"}),$("#temp-c-button").css({"background-color":"#333","box-shadow":"none"}))}var refreshTime=6e5,timeToRefresh=null,currentLatLng=[],isUS=null,tempF=null,tempC=null,windM=null,windK=null;$(document).ready(function(){isUS=$.parseJSON(localStorage.getItem("isUS")),null==isUS&&(isUS=!0,localStorage.setItem("isUS","true")),isUS===!1&&setTempButtons(!1,!1),navigator.geolocation?navigator.geolocation.getCurrentPosition(geo_success,geo_error,{timeout:3e4}):geo_error(),$("#temp-f-button").on("click",function(t){t.preventDefault(),isUS===!1&&setTempButtons(!0,!0)}),$("#temp-c-button").on("click",function(t){t.preventDefault(),isUS===!0&&setTempButtons(!1,!0)})});